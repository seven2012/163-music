$(function(){setTimeout(function(){$.get("./songs.json").then(function(response){let items=response;items.forEach(i=>{let $li=$(`\n\t\t\t\t\t<li>\n                   <a href="./song.html?id=${i.id}">\n                        <h3>${i.name}</h3>\n                        <p>\n                        <img src="./images/sq.png" alt="">\n                        <span>演唱者-${i.singer}</span>                       \n                        </p>\n                    </a>\n                    <a href="./song.html?id=${i.id}">\n                        <svg class="icon-link-play" aria-hidden="true">\n                            <use xlink:href="#icon-link-play"></use>\n                        </svg>\n                    </a>\n\n                </li>\n\t\t\t\t\t`);$(".latestMusic").append($li)});$("#lastestMusicLoading").remove()})},1e3);$(".m-homenav").on("click","ol.tabItems>li",function(e){let $li=$(e.currentTarget).addClass("active");$li.siblings().removeClass("active");let index=$li.index();$li.trigger("tabChange",index);$("#container > li").eq(index).addClass("active").siblings().removeClass("active")});$(".m-homenav").on("tabChange",function(e,index){let $li=$("#container > li").eq(index);if($li.attr("data-downloaded")==="yes"){return}if(index===1){$.get("./page2.json").then(response=>{let items=response;items.forEach(i=>{let $li2=$(`\n\t\t\t\t\t<li>\n                        <a class="hrefSong" href="./song.html?id=${i.id}">\n                            <div class="songId">${i.number}</div>\n                            <div class=songerInfo>\n                                    <h3>${i.name}</h3>\n                                    <p>\n                                    <img src="./images/sq.png" alt="">\n                                    <span>演唱者-${i.singer}</span>\n                                    </p>                       \n                            </div>                      \n                            <svg class="icon-link-play" aria-hidden="true">\n                                <use xlink:href="#icon-link-play"></use>\n                            </svg>                           \n                        </a>\n                </li>\n\t\t\t\t\t`);$(".hotcontent > ol").append($li2)});$li.attr("data-downloaded","yes");$("#tab2Loading").remove()})}else if(index===2){return;$.get("./page3.json").then(response=>{$li.text(response.content);$li.attr("data-downloaded","yes")})}});let timer=undefined;$("input#searchSong").on("input",function(e){let $input=$(e.currentTarget);let value=$input.val().trim();if(value===""){return}if(timer){clearTimeout(timer)}timer=setTimeout(function(){search(value).then(result=>{timer=undefined;if(result.length!==0){$("#output").empty();let $ul=$("<ul></ul>");result.forEach(item=>{let $li=$(`\n                        <li><a href="./song.html?id=${item.id}">${item.name}</a></li>\n                        `);$li.appendTo($ul)});$("#output").append($ul)}else{$("#output").html("没有结果")}})},300)});function search(keyword){console.log("搜索"+keyword);return new Promise((resolve,reject)=>{var database=[{id:1,name:"别找我麻烦"},{id:2,name:"喜欢你"},{id:3,name:"I'm Yours"},{id:4,name:"A Thousand Year"},{id:5,name:"Love In December"},{id:6,name:"You Are Beautiful"},{id:7,name:"旅途"},{id:8,name:"稻香"},{id:9,name:"夜曲"},{id:10,name:"不要再孤单"}];let result=database.filter(function(item){return item.name.indexOf(keyword)>=0});setTimeout(function(){console.log("搜到"+keyword+"的结果");resolve(result)},Math.random()*200+1e3)})}window.search=search});
